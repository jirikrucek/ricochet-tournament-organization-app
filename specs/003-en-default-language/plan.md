# Implementation Plan: Change Default Language from Polish to English

**Branch**: `003-en-default-language` | **Date**: 2026-02-17 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/003-en-default-language/spec.md`

**Note**: This plan was generated by the `/speckit.plan` command.

## Summary

This feature changes the i18n fallback language from Polish to English to improve international accessibility. The implementation requires modifying the i18n configuration to set English as the default, importing all 5 language files (including German and Czech which are currently excluded), completing the German and Czech translations to match the 220 keys in other language files, and updating the language selector UI to display all 5 languages. This is a low-complexity feature with no architectural changes‚Äîonly configuration updates and translation content completion.

## Technical Context

**Language/Version**: React 19.2 (JavaScript/ES6+) with Vite 5.x  
**Primary Dependencies**: 
- i18next 25.8.0 - Internationalization framework
- i18next-browser-languagedetector 8.2.0 - Automatic language detection
- react-i18next 16.5.3 - React bindings for i18next

**Storage**: LocalStorage for language preference caching (key: `i18nextLng`)  
**Testing**: Vitest with jsdom environment, React Testing Library  
**Target Platform**: Web browsers (modern, ES6+ support)  
**Project Type**: Single-page application (SPA) with Vite build system  
**Performance Goals**: Language switching within 1 second, immediate language detection on first load  
**Constraints**: Must maintain 5-language support synchronization (220 translation keys per file), backward compatibility with existing user language preferences  
**Scale/Scope**: 5 languages x 220 translation keys = 1,100 total translations, ~163 missing German translations, ~163 missing Czech translations

**Current i18n State**:
- 3 of 5 languages currently imported (pl, en, nl)
- German (de.json) and Czech (cs.json) exist but not imported
- de.json and cs.json have 57 keys each (incomplete, need 220)
- LanguageSelector shows only 3 languages
- Fallback language is 'pl' (Polish)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Required Principles Compliance

- [x] **DDD**: Does the feature respect bounded contexts? (Tournament management, match tracking, player profiles)
  - ‚úÖ **YES** - This feature only touches the i18n configuration and translation files, which are infrastructure concerns separate from domain logic. No domain boundaries are crossed.

- [x] **TDD**: Are test requirements identified? (Priority 1: business logic, Priority 2: hooks, Priority 3: components)
  - ‚úÖ **YES** - Testing requirements identified in spec:
    - Priority 3: LanguageSelector component rendering (verify all 5 languages appear)
    - Integration: Test language switching and fallback behavior
    - Manual: Verify German/Czech translations are complete

- [x] **SOLID**: Does the design follow single responsibility? Are dependencies properly inverted?
  - ‚úÖ **YES** - i18n configuration remains in dedicated config file (SRP). Components depend on i18next abstraction via useTranslation hook (DIP). No changes to component structure required.

- [x] **Dual-Mode**: Does the feature work with BOTH Supabase and localStorage?
  - ‚úÖ **YES** - This feature only affects client-side i18n configuration. Language preference is already stored in localStorage by i18next. No Supabase interaction required.

- [x] **i18n**: Will UI changes require updates to all 5 language files?
  - ‚úÖ **YES** - This feature IS the i18n update. All 5 language files will be complete after implementation (de.json and cs.json will be expanded from 57 to 220 keys).

- [x] **Domain Integrity**: Does the feature affect bracket logic, match IDs, or drop patterns? If yes, requires extra validation.
  - ‚úÖ **NO** - This feature only affects UI text display. No impact on tournament bracket logic, match state, or domain rules.

### Technology Stack Verification

- [x] Uses React 19.2 functional components (no new class components except ErrorBoundary)
  - ‚úÖ **YES** - No new components created. Only modifying existing LanguageSelector.jsx (already a functional component).

- [x] Uses Context API for state (not Redux or other libraries)
  - ‚úÖ **YES** - i18next provides its own state management via useTranslation hook. No global state changes needed.

- [x] Custom hooks for data operations (not direct database access)
  - ‚úÖ **N/A** - No data operations involved. This is configuration and static content only.

- [x] File organization follows `pages/`, `components/`, `hooks/`, `utils/`, `contexts/` structure
  - ‚úÖ **YES** - Files being modified:
    - `src/i18n/config.js` - Configuration (existing location correct)
    - `src/i18n/{de,cs}.json` - Translation files (existing location correct)
    - `src/components/LanguageSelector.jsx` - Component (existing location correct)

### Code Standards Gates

- [x] ESLint compliance confirmed
  - ‚úÖ **YES** - Changes are JSON data and simple config modifications. No complex logic that could violate ESLint rules.

- [x] Import ordering: external libs ‚Üí internal modules ‚Üí styles
  - ‚úÖ **YES** - config.js already follows correct import order. New imports will follow same pattern (JSON files imported after i18next imports).

- [x] File extension: `.jsx` for components, `.js` for utilities
  - ‚úÖ **YES** - No new files created. Existing files already follow convention (config.js, LanguageSelector.jsx).

- [x] localStorage keys use `ricochet_*` prefix if applicable
  - ‚úÖ **N/A** - Language preference uses i18next's default key (`i18nextLng`), which is a library convention. Not modifying localStorage directly.

**GATE STATUS: ‚úÖ PASSED** - All constitution requirements met. No violations to justify. Proceeding to Phase 0.

## Project Structure

### Documentation (this feature)

```text
specs/[###-feature]/
‚îú‚îÄ‚îÄ plan.md              # This file (/speckit.plan command output)
‚îú‚îÄ‚îÄ research.md          # Phase 0 output (/speckit.plan command)
‚îú‚îÄ‚îÄ data-model.md        # Phase 1 output (/speckit.plan command)
‚îú‚îÄ‚îÄ quickstart.md        # Phase 1 output (/speckit.plan command)
‚îú‚îÄ‚îÄ contracts/           # Phase 1 output (/speckit.plan command)
‚îî‚îÄ‚îÄ tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

This is a single-project React application with Vite build system. No backend or mobile components.

```text
src/
‚îú‚îÄ‚îÄ i18n/                    # ‚ö†Ô∏è PRIMARY WORK AREA
‚îÇ   ‚îú‚îÄ‚îÄ config.js           # üîß MODIFY: Change fallbackLng, add de/cs imports
‚îÇ   ‚îú‚îÄ‚îÄ en.json             # ‚úÖ REFERENCE: Complete (220 keys)
‚îÇ   ‚îú‚îÄ‚îÄ pl.json             # ‚úÖ REFERENCE: Complete (220 keys)
‚îÇ   ‚îú‚îÄ‚îÄ nl.json             # ‚úÖ REFERENCE: Complete (220 keys)
‚îÇ   ‚îú‚îÄ‚îÄ de.json             # üîß EXPAND: 57 ‚Üí 220 keys
‚îÇ   ‚îî‚îÄ‚îÄ cs.json             # üîß EXPAND: 57 ‚Üí 220 keys
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ LanguageSelector.jsx  # üîß MODIFY: Add de/cs to LANGUAGES array
‚îú‚îÄ‚îÄ pages/                   # ‚úÖ NO CHANGES
‚îú‚îÄ‚îÄ hooks/                   # ‚úÖ NO CHANGES
‚îú‚îÄ‚îÄ utils/                   # ‚úÖ NO CHANGES
‚îú‚îÄ‚îÄ contexts/                # ‚úÖ NO CHANGES
‚îî‚îÄ‚îÄ lib/                     # ‚úÖ NO CHANGES

# No test files need modification (manual testing sufficient for i18n changes)
```

**Structure Decision**: This feature modifies exactly 4 files:
1. `src/i18n/config.js` - Add imports, modify configuration
2. `src/i18n/de.json` - Complete translations (add ~163 keys)
3. `src/i18n/cs.json` - Complete translations (add ~163 keys)
4. `src/components/LanguageSelector.jsx` - Add language options to dropdown

**Blast Radius**: Low - Changes are isolated to i18n infrastructure. No domain logic, API, or state management affected.

## Complexity Tracking

**No violations** - All constitution checks passed. No complexity justification required.

This feature is straightforward:
- Configuration change (1 property value change + 2 imports)
- Translation content completion (copy-paste structure from existing files)
- UI update (add 2 array items)

No architectural decisions, no new patterns, no infrastructure changes.

## Phase 0 Complete: Research ‚úÖ

**Artifact Created**: [research.md](research.md)

**Key Findings**:
- Current i18n implementation uses i18next 25.8.0 with browser language detection
- German and Czech files exist but are incomplete (57/220 keys)
- English file is complete and will serve as translation reference
- Language selector currently shows only 3 of 5 available languages
- Fallback behavior is functional but currently uses Polish as default

**Unknowns Resolved**: None - all technical details were clear from codebase inspection

## Phase 1 Complete: Design ‚úÖ
## Phase 1 Complete: Design ‚úÖ
l technical details were clear from codebase inspection
re and language preference schema
2. [quickstart.md](quickstart.md) - Step-by-step implementation guide for developers
3. No contracts/ needed - This is client-side only, no API changes

**Design Decisions**:
1. **Translation Strategy**: Use AI-assisted translation with English as source, manual review for tournament-specific terms
2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2. **File Changes**: Exac2. **File Changes**: Eing Approach**: Manua2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2. **File Changes**:on2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2.t 2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2. inci2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2. ** ST2. **File Changes**: Exac2. **File Changes**: Exac2. **Fi de2. ** [x] **2. **File Changes**: Exac2. **Fiuirements remain Priority 3 (manual testing sufficient)
### Estimated Impact

| Area                    | Change type  | LoC (approx) | Complexity |
|-------------------------|--------------|--------------|------------|
| i18n config             | Config update| ~10          | Low        |
| Translation files       | Content add  | ~320         | Low        |
| Language selector (UI)  | Array update | ~5           | Low        |
| LocalStorage interaction| Config check | ~6           | Low        |
**Total Impact**: 4 files, ~341 lines added/changed, all low complexity

### Dependencies

**Internal**: None - no cross-file dependencies  
**External**: None - no new package installations  
**Data**: None - no database changes  
**API**: None - no backend changes

### Risk Assessment

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------|--------|------|--------|------|--------|------|--------|------|- ||------|--------|------|--------|------|--------|------|--------|------|--------|------|- ||------|--------|------|--------|------|--------|------|--------|------|--------|------|- ||------|--------|------|--------|------|--------|------|--------|------|--------|------|- ||------|--------|------|--------|------|--------|--**|------|--------|------|--------|------|--------|rsi|------|--------|------|--------|------|--------|--pe|------|--------|------|--------|------|------gene|------|--------|------|--------|------|-----with |------|--------|------|--------|------|--------|------|--------|-sti|------|--------|------|--------|------|--------|------|--------|-----eview [quickstart.md]|------|--------|------|--------|------|-------- S|------|--------|------|--------|------|--------|-ch|------|--------|------|--------|---Manual testing across all 5 languages
5555555555555555equest5555555555555555equesg evidence

### For Review

When reviewing PR, verify:
- All 5 language files have exactly 220 keys each
-  is set to 'en'
- Language selector shows all 5 languages
- Manual testing evidence provided (screenshots/video)
- No ESLint errors
- Successful build

## Summary

**Feature**: Change default i18n language from Polish to English  
**Branch**:   
**Status**: Planning Complete ‚úÖ  
**Complexity**: Low  
**Risk**: Low  
**Estimated Effort**: 4-7 hours  

**Key Deliverables**:
1. ‚úÖ research.md - Current state analysis
2. ‚úÖ data-model.md - Translation structure documentation  
3. ‚úÖ quickstart.md - Implementation guide
4. ‚úÖ plan.md - This file
5. ‚è∏Ô∏è tasks.md - Generate with  command

**Constitution Compliance**: ‚úÖ All principles passed  
**Ready for Implementation**: ‚úÖ Yes

---

**Plan generated by**:  command  
**Date**: 2026-02-17  
**Planning Phase**: Complete
